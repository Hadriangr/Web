{% extends 'base.html' %}
{% load static %}

{% block title %}
    Resumen del Carrito
{% endblock %}

{% block content %}
<h1>Resumen del Carrito</h1>

<!-- Mostrar ítems de Categoría -->
<h2>Examenes:</h2> <br>
<ul>
    {% for categoria, items in items_por_categoria.items %}
    <h3>{{ categoria.nombre }}</h3>
    <ul>
        {% for item in items %}
        <li>
            {{ item.nombre }} 
            <form class="eliminar-form" action="{% url 'eliminar_producto' item.pk %}" method="post">
                {% csrf_token %}
                <button type="submit">Eliminar</button>
            </form>
        </li>
        {% endfor %}
    </ul>
    {% endfor %}
    <h4>Precio Total de Exámenes: {{ precio_total_categorias }}</h4>
</ul>

<!-- Mostrar ítems de Derivación -->
<h2>Derivaciones:</h2> <br>
<ul>
    {% for derivacion, items_derivacion in items_por_derivacion.items %}
    <h3>{{ derivacion.nombre }}</h3>
    <ul>
        {% for item in items_derivacion %}
        <li>
            {{ item.nombre }} 
            <form class="eliminar-form" action="{% url 'eliminar_derivacion' item.pk %}" method="post">
                {% csrf_token %}
                <button type="submit">Eliminar</button>
            </form>
        </li>
        {% endfor %}
    </ul>
    {% endfor %}
    <h4>Precio Total de Derivaciones: {{ precio_total_derivaciones }}</h4>
</ul>

<h4>Precio Total del Carrito: {{ precio_total }}</h4>

<!-- Botón de Pagar -->
<form method="get" action="{% url 'pago_exitoso' %}">
    {% csrf_token %}
    <button type="submit" {% if items_por_categoria|length == 0 and items_por_derivacion|length == 0 %}disabled{% endif %}>Pagar</button>
</form>


<!-- Formulario de Inicio de Sesión / Registro -->
<div>

</div>
{% endblock %}
